"use strict";(self.webpackChunkreact_map_components_maplibre_lab=self.webpackChunkreact_map_components_maplibre_lab||[]).push([[561],{643842:(t,e,n)=>{n.r(e),n.d(e,{default:()=>r});class r{constructor(t=[],e=o){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,r=e[t];for(;t>0;){const o=t-1>>1,i=e[o];if(n(r,i)>=0)break;e[t]=i,t=o}e[t]=r}_down(t){const{data:e,compare:n}=this,r=this.length>>1,o=e[t];for(;t<r;){let r=1+(t<<1),i=e[r];const a=r+1;if(a<this.length&&n(e[a],i)<0&&(r=a,i=e[a]),n(i,o)>=0)break;e[t]=i,t=r}e[t]=o}}function o(t,e){return t<e?-1:t>e?1:0}},818146:(t,e,n)=>{function r(t){return t}function o(t){if(null==t)return r;var e,n,o=t.scale[0],i=t.scale[1],a=t.translate[0],s=t.translate[1];return function(t,r){r||(e=n=0);var c=2,u=t.length,l=new Array(u);for(l[0]=(e+=t[0])*o+a,l[1]=(n+=t[1])*i+s;c<u;)l[c]=t[c],++c;return l}}function i(t){var e,n=o(t.transform),r=1/0,i=r,a=-r,s=-r;function c(t){(t=n(t))[0]<r&&(r=t[0]),t[0]>a&&(a=t[0]),t[1]<i&&(i=t[1]),t[1]>s&&(s=t[1])}function u(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(u);break;case"Point":c(t.coordinates);break;case"MultiPoint":t.coordinates.forEach(c)}}for(e in t.arcs.forEach((function(t){for(var e,o=-1,c=t.length;++o<c;)(e=n(t[o],o))[0]<r&&(r=e[0]),e[0]>a&&(a=e[0]),e[1]<i&&(i=e[1]),e[1]>s&&(s=e[1])})),t.objects)u(t.objects[e]);return[r,i,a,s]}function a(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return s(t,e)}))}:s(t,e)}function s(t,e){var n=e.id,r=e.bbox,o=null==e.properties?{}:e.properties,i=c(t,e);return null==n&&null==r?{type:"Feature",properties:o,geometry:i}:null==r?{type:"Feature",id:n,properties:o,geometry:i}:{type:"Feature",id:n,bbox:r,properties:o,geometry:i}}function c(t,e){var n=o(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var o=r[t<0?~t:t],i=0,a=o.length;i<a;++i)e.push(n(o[i],i));t<0&&function(t,e){for(var n,r=t.length,o=r-e;o<--r;)n=t[o],t[o++]=t[r],t[r]=n}(e,a)}function a(t){return n(t)}function s(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function c(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function u(t){return t.map(c)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=s(e.arcs);break;case"MultiLineString":n=e.arcs.map(s);break;case"Polygon":n=u(e.arcs);break;case"MultiPolygon":n=e.arcs.map(u);break;default:return null}return{type:r,coordinates:n}}(e)}function u(t,e){var n={},r={},o={},i=[],a=-1;function s(t,e){for(var r in t){var o=t[r];delete e[o.start],delete o.start,delete o.end,o.forEach((function(t){n[t<0?~t:t]=1})),i.push(o)}}return e.forEach((function(n,r){var o,i=t.arcs[n<0?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(o=e[++a],e[a]=n,e[r]=o)})),e.forEach((function(e){var n,i,a=function(e){var n,r=t.arcs[e<0?~e:e],o=r[0];return t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1],e<0?[n,o]:[o,n]}(e),s=a[0],c=a[1];if(n=o[s])if(delete o[n.end],n.push(e),n.end=c,i=r[c]){delete r[i.start];var u=i===n?n:n.concat(i);r[u.start=n.start]=o[u.end=i.end]=u}else r[n.start]=o[n.end]=n;else if(n=r[c])if(delete r[n.start],n.unshift(e),n.start=s,i=o[s]){delete o[i.end];var l=i===n?n:i.concat(n);r[l.start=i.start]=o[l.end=n.end]=l}else r[n.start]=o[n.end]=n;else r[(n=[e]).start=s]=o[n.end=c]=n})),s(o,r),s(r,o),e.forEach((function(t){n[t<0?~t:t]||i.push([t])})),i}function l(t){return c(t,f.apply(this,arguments))}function f(t,e,n){var r,o,i;if(arguments.length>1)r=function(t,e,n){var r,o=[],i=[];function a(t){var e=t<0?~t:t;(i[e]||(i[e]=[])).push({i:t,g:r})}function s(t){t.forEach(a)}function c(t){t.forEach(s)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":c(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(c)}(e.arcs)}}(e),i.forEach(null==n?function(t){o.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&o.push(t[0].i)}),o}(0,e,n);else for(o=0,r=new Array(i=t.arcs.length);o<i;++o)r[o]=o;return{type:"MultiLineString",arcs:u(t,r)}}function h(t){return c(t,p.apply(this,arguments))}function p(t,e){var n={},r=[],o=[];function i(t){t.forEach((function(e){e.forEach((function(e){(n[e=e<0?~e:e]||(n[e]=[])).push(t)}))})),r.push(t)}function a(e){return function(t){for(var e,n=-1,r=t.length,o=t[r-1],i=0;++n<r;)e=o,o=t[n],i+=e[0]*o[1]-e[1]*o[0];return Math.abs(i)}(c(t,{type:"Polygon",arcs:[e]}).coordinates[0])}return e.forEach((function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":i(e.arcs);break;case"MultiPolygon":e.arcs.forEach(i)}})),r.forEach((function(t){if(!t._){var e=[],r=[t];for(t._=1,o.push(e);t=r.pop();)e.push(t),t.forEach((function(t){t.forEach((function(t){n[t<0?~t:t].forEach((function(t){t._||(t._=1,r.push(t))}))}))}))}})),r.forEach((function(t){delete t._})),{type:"MultiPolygon",arcs:o.map((function(e){var r,o=[];if(e.forEach((function(t){t.forEach((function(t){t.forEach((function(t){n[t<0?~t:t].length<2&&o.push(t)}))}))})),(r=(o=u(t,o)).length)>1)for(var i,s,c=1,l=a(o[0]);c<r;++c)(i=a(o[c]))>l&&(s=o[0],o[0]=o[c],o[c]=s,l=i);return o})).filter((function(t){return t.length>0}))}}function g(t,e){for(var n=0,r=t.length;n<r;){var o=n+r>>>1;t[o]<e?n=o+1:r=o}return n}function d(t){var e={},n=t.map((function(){return[]}));function r(t,n){t.forEach((function(t){t<0&&(t=~t);var r=e[t];r?r.push(n):e[t]=[n]}))}function o(t,e){t.forEach((function(t){r(t,e)}))}var i={LineString:r,MultiLineString:o,Polygon:o,MultiPolygon:function(t,e){t.forEach((function(t){o(t,e)}))}};for(var a in t.forEach((function t(e,n){"GeometryCollection"===e.type?e.geometries.forEach((function(e){t(e,n)})):e.type in i&&i[e.type](e.arcs,n)})),e)for(var s=e[a],c=s.length,u=0;u<c;++u)for(var l=u+1;l<c;++l){var f,h=s[u],p=s[l];(f=n[h])[a=g(f,p)]!==p&&f.splice(a,0,p),(f=n[p])[a=g(f,h)]!==h&&f.splice(a,0,h)}return n}function y(t){if(null==t)return r;var e,n,o=t.scale[0],i=t.scale[1],a=t.translate[0],s=t.translate[1];return function(t,r){r||(e=n=0);var c=2,u=t.length,l=new Array(u),f=Math.round((t[0]-a)/o),h=Math.round((t[1]-s)/i);for(l[0]=f-e,e=f,l[1]=h-n,n=h;c<u;)l[c]=t[c],++c;return l}}function m(t,e){if(t.transform)throw new Error("already quantized");if(e&&e.scale)c=t.bbox;else{if(!((n=Math.floor(e))>=2))throw new Error("n must be â‰¥2");var n,r=(c=t.bbox||i(t))[0],o=c[1],a=c[2],s=c[3];e={scale:[a-r?(a-r)/(n-1):1,s-o?(s-o)/(n-1):1],translate:[r,o]}}var c,u,l=y(e),f=t.objects,h={};function p(t){return l(t)}function g(t){var e;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(g)};break;case"Point":e={type:"Point",coordinates:p(t.coordinates)};break;case"MultiPoint":e={type:"MultiPoint",coordinates:t.coordinates.map(p)};break;default:return t}return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}for(u in f)h[u]=g(f[u]);return{type:"Topology",bbox:c,transform:e,objects:h,arcs:t.arcs.map((function(t){var e,n=0,r=1,o=t.length,i=new Array(o);for(i[0]=l(t[0],0);++n<o;)((e=l(t[n],n))[0]||e[1])&&(i[r++]=e);return 1===r&&(i[r++]=[0,0]),i.length=r,i}))}}n.r(e),n.d(e,{bbox:()=>i,feature:()=>a,merge:()=>h,mergeArcs:()=>p,mesh:()=>l,meshArcs:()=>f,neighbors:()=>d,quantize:()=>m,transform:()=>o,untransform:()=>y})},724255:(t,e,n)=>{n.r(e),n.d(e,{topology:()=>g});var r=Object.prototype.hasOwnProperty;function o(t,e,n,r,o,i){3===arguments.length&&(r=i=Array,o=null);for(var a=new r(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),s=new i(t),c=t-1,u=0;u<t;++u)a[u]=o;return{set:function(r,i){for(var u=e(r)&c,l=a[u],f=0;l!=o;){if(n(l,r))return s[u]=i;if(++f>=t)throw new Error("full hashmap");l=a[u=u+1&c]}return a[u]=r,s[u]=i,i},maybeSet:function(r,i){for(var u=e(r)&c,l=a[u],f=0;l!=o;){if(n(l,r))return s[u];if(++f>=t)throw new Error("full hashmap");l=a[u=u+1&c]}return a[u]=r,s[u]=i,i},get:function(r,i){for(var u=e(r)&c,l=a[u],f=0;l!=o;){if(n(l,r))return s[u];if(++f>=t)break;l=a[u=u+1&c]}return i},keys:function(){for(var t=[],e=0,n=a.length;e<n;++e){var r=a[e];r!=o&&t.push(r)}return t}}}function i(t,e){return t[0]===e[0]&&t[1]===e[1]}var a=new ArrayBuffer(16),s=new Float64Array(a),c=new Uint32Array(a);function u(t){s[0]=t[0],s[1]=t[1];var e=c[0]^c[1];return 2147483647&(e<<5^e>>7^c[2]^c[3])}function l(t,e,n){for(var r,o=e+(n---e>>1);e<o;++e,--n)r=t[e],t[e]=t[n],t[n]=r}function f(t){var e={type:"GeometryCollection",geometries:t.features.map(h)};return null!=t.bbox&&(e.bbox=t.bbox),e}function h(t){var e,n=p(t.geometry);for(e in null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox),t.properties){n.properties=t.properties;break}return n}function p(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(p)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}function g(t,e){var n=function(t){var e=1/0,n=1/0,o=-1/0,i=-1/0;function a(t){null!=t&&r.call(s,t.type)&&s[t.type](t)}var s={GeometryCollection:function(t){t.geometries.forEach(a)},Point:function(t){c(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(c)},LineString:function(t){u(t.arcs)},MultiLineString:function(t){t.arcs.forEach(u)},Polygon:function(t){t.arcs.forEach(u)},MultiPolygon:function(t){t.arcs.forEach(l)}};function c(t){var r=t[0],a=t[1];r<e&&(e=r),r>o&&(o=r),a<n&&(n=a),a>i&&(i=a)}function u(t){t.forEach(c)}function l(t){t.forEach(u)}for(var f in t)a(t[f]);return o>=e&&i>=n?[e,n,o,i]:void 0}(t=function(t){var e,n,r={};for(e in t)r[e]=null==(n=t[e])?{type:null}:("FeatureCollection"===n.type?f:"Feature"===n.type?h:p)(n);return r}(t)),a=e>0&&n&&function(t,e,n){var o=e[0],i=e[1],a=e[2],s=e[3],c=a-o?(n-1)/(a-o):1,u=s-i?(n-1)/(s-i):1;function l(t){return[Math.round((t[0]-o)*c),Math.round((t[1]-i)*u)]}function f(t,e){for(var n,r,a,s,l,f=-1,h=0,p=t.length,g=new Array(p);++f<p;)n=t[f],s=Math.round((n[0]-o)*c),l=Math.round((n[1]-i)*u),s===r&&l===a||(g[h++]=[r=s,a=l]);for(g.length=h;h<e;)h=g.push([g[0][0],g[0][1]]);return g}function h(t){return f(t,2)}function p(t){return f(t,4)}function g(t){return t.map(p)}function d(t){null!=t&&r.call(y,t.type)&&y[t.type](t)}var y={GeometryCollection:function(t){t.geometries.forEach(d)},Point:function(t){t.coordinates=l(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(l)},LineString:function(t){t.arcs=h(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(h)},Polygon:function(t){t.arcs=g(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(g)}};for(var m in t)d(t[m]);return{scale:[1/c,1/u],translate:[o,i]}}(t,n,e),s=function(t){var e,n,r,a,s=t.coordinates,c=t.lines,l=t.rings,f=c.length+l.length;for(delete t.lines,delete t.rings,r=0,a=c.length;r<a;++r)for(e=c[r];e=e.next;)++f;for(r=0,a=l.length;r<a;++r)for(n=l[r];n=n.next;)++f;var h=o(2*f*1.4,u,i),p=t.arcs=[];for(r=0,a=c.length;r<a;++r){e=c[r];do{g(e)}while(e=e.next)}for(r=0,a=l.length;r<a;++r)if((n=l[r]).next)do{g(n)}while(n=n.next);else d(n);function g(t){var e,n,r,o,i,a,c,u;if(r=h.get(e=s[t[0]]))for(c=0,u=r.length;c<u;++c)if(y(o=r[c],t))return t[0]=o[0],void(t[1]=o[1]);if(i=h.get(n=s[t[1]]))for(c=0,u=i.length;c<u;++c)if(m(a=i[c],t))return t[1]=a[0],void(t[0]=a[1]);r?r.push(t):h.set(e,[t]),i?i.push(t):h.set(n,[t]),p.push(t)}function d(t){var e,n,r,o,i;if(n=h.get(s[t[0]]))for(o=0,i=n.length;o<i;++o){if(b(r=n[o],t))return t[0]=r[0],void(t[1]=r[1]);if(v(r,t))return t[0]=r[1],void(t[1]=r[0])}if(n=h.get(e=s[t[0]+x(t)]))for(o=0,i=n.length;o<i;++o){if(b(r=n[o],t))return t[0]=r[0],void(t[1]=r[1]);if(v(r,t))return t[0]=r[1],void(t[1]=r[0])}n?n.push(t):h.set(e,[t]),p.push(t)}function y(t,e){var n=t[0],r=e[0],o=t[1];if(n-o!=r-e[1])return!1;for(;n<=o;++n,++r)if(!i(s[n],s[r]))return!1;return!0}function m(t,e){var n=t[0],r=e[0],o=t[1],a=e[1];if(n-o!=r-a)return!1;for(;n<=o;++n,--a)if(!i(s[n],s[a]))return!1;return!0}function b(t,e){var n=t[0],r=e[0],o=t[1]-n;if(o!==e[1]-r)return!1;for(var a=x(t),c=x(e),u=0;u<o;++u)if(!i(s[n+(u+a)%o],s[r+(u+c)%o]))return!1;return!0}function v(t,e){var n=t[0],r=e[0],o=t[1],a=e[1],c=o-n;if(c!==a-r)return!1;for(var u=x(t),l=c-x(e),f=0;f<c;++f)if(!i(s[n+(f+u)%c],s[a-(f+l)%c]))return!1;return!0}function x(t){for(var e=t[0],n=t[1],r=e,o=r,i=s[r];++r<n;){var a=s[r];(a[0]<i[0]||a[0]===i[0]&&a[1]<i[1])&&(o=r,i=a)}return o-e}return t}(function(t){var e,n,r,a,s,c,f,h=function(t){var e,n,r,a,s=t.coordinates,c=t.lines,l=t.rings,f=function(){for(var t=o(1.4*s.length,M,E,Int32Array,-1,Int32Array),e=new Int32Array(s.length),n=0,r=s.length;n<r;++n)e[n]=t.maybeSet(n,n);return e}(),h=new Int32Array(s.length),p=new Int32Array(s.length),g=new Int32Array(s.length),d=new Int8Array(s.length),y=0;for(e=0,n=s.length;e<n;++e)h[e]=p[e]=g[e]=-1;for(e=0,n=c.length;e<n;++e){var m=c[e],b=m[0],v=m[1];for(r=f[b],a=f[++b],++y,d[r]=1;++b<=v;)w(e,r,r=a,a=f[b]);++y,d[a]=1}for(e=0,n=s.length;e<n;++e)h[e]=-1;for(e=0,n=l.length;e<n;++e){var x=l[e],k=x[0]+1,N=x[1];for(w(e,f[N-1],r=f[k-1],a=f[k]);++k<=N;)w(e,r,r=a,a=f[k])}function w(t,e,n,r){if(h[n]!==t){h[n]=t;var o=p[n];if(o>=0){var i=g[n];o===e&&i===r||o===r&&i===e||(++y,d[n]=1)}else p[n]=e,g[n]=r}}function M(t){return u(s[t])}function E(t,e){return i(s[t],s[e])}h=p=g=null;var P,A=function(t,e,n,r,o){3===arguments.length&&(r=Array,o=null);for(var i=new r(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),a=t-1,s=0;s<t;++s)i[s]=o;return{add:function(r){for(var s=e(r)&a,c=i[s],u=0;c!=o;){if(n(c,r))return!0;if(++u>=t)throw new Error("full hashset");c=i[s=s+1&a]}return i[s]=r,!0},has:function(r){for(var s=e(r)&a,c=i[s],u=0;c!=o;){if(n(c,r))return!0;if(++u>=t)break;c=i[s=s+1&a]}return!1},values:function(){for(var t=[],e=0,n=i.length;e<n;++e){var r=i[e];r!=o&&t.push(r)}return t}}}(1.4*y,u,i);for(e=0,n=s.length;e<n;++e)d[P=f[e]]&&A.add(s[P]);return A}(t),p=t.coordinates,g=t.lines,d=t.rings;for(n=0,r=g.length;n<r;++n)for(var y=g[n],m=y[0],b=y[1];++m<b;)h.has(p[m])&&(e={0:m,1:y[1]},y[1]=m,y=y.next=e);for(n=0,r=d.length;n<r;++n)for(var v=d[n],x=v[0],k=x,N=v[1],w=h.has(p[x]);++k<N;)h.has(p[k])&&(w?(e={0:k,1:v[1]},v[1]=k,v=v.next=e):(f=N-k,l(a=p,s=x,c=N),l(a,s,s+f),l(a,s+f,c),p[N]=p[x],w=!0,k=x));return t}(function(t){var e=-1,n=[],o=[],i=[];function a(t){t&&r.call(s,t.type)&&s[t.type](t)}var s={GeometryCollection:function(t){t.geometries.forEach(a)},LineString:function(t){t.arcs=c(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(c)},Polygon:function(t){t.arcs=t.arcs.map(u)},MultiPolygon:function(t){t.arcs=t.arcs.map(l)}};function c(t){for(var r=0,o=t.length;r<o;++r)i[++e]=t[r];var a={0:e-o+1,1:e};return n.push(a),a}function u(t){for(var n=0,r=t.length;n<r;++n)i[++e]=t[n];var a={0:e-r+1,1:e};return o.push(a),a}function l(t){return t.map(u)}for(var f in t)a(t[f]);return{type:"Topology",coordinates:i,lines:n,rings:o,objects:t}}(t))),c=s.coordinates,g=o(1.4*s.arcs.length,d,y);function m(t){t&&r.call(b,t.type)&&b[t.type](t)}t=s.objects,s.bbox=n,s.arcs=s.arcs.map((function(t,e){return g.set(t,e),c.slice(t[0],t[1]+1)})),delete s.coordinates,c=null;var b={GeometryCollection:function(t){t.geometries.forEach(m)},LineString:function(t){t.arcs=v(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(v)},Polygon:function(t){t.arcs=t.arcs.map(v)},MultiPolygon:function(t){t.arcs=t.arcs.map(x)}};function v(t){var e=[];do{var n=g.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function x(t){return t.map(v)}for(var k in t)m(t[k]);return a&&(s.transform=a,s.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var r,o,i=t[e],a=0,s=1,c=i.length,u=i[0],l=u[0],f=u[1];++a<c;)r=(u=i[a])[0],o=u[1],r===l&&o===f||(i[s++]=[r-l,o-f],l=r,f=o);1===s&&(i[s++]=[0,0]),i.length=s}return t}(s.arcs)),s}function d(t){var e,n=t[0],r=t[1];return r<n&&(e=n,n=r,r=e),n+31*r}function y(t,e){var n,r=t[0],o=t[1],i=e[0],a=e[1];return o<r&&(n=r,r=o,o=n),a<i&&(n=i,i=a,a=n),r===i&&o===a}},301111:(t,e)=>{function n(t,e){return Array.from(t.getElementsByTagName(e))}function r(t){return"#"===t[0]?t:`#${t}`}function o(t){return t?.normalize(),t&&t.textContent||""}function i(t,e,n){const r=t.getElementsByTagName(e),o=r.length?r[0]:null;return o&&n&&n(o),o}function a(t,e,n){const r={};if(!t)return r;const o=t.getElementsByTagName(e),i=o.length?o[0]:null;return i&&n?n(i,r):r}function s(t,e,n){const r=o(i(t,e));return r&&n&&n(r)||{}}function c(t,e,n){const r=parseFloat(o(i(t,e)));if(!isNaN(r))return r&&n&&n(r)||{}}function u(t,e,n){const r=parseFloat(o(i(t,e)));if(!isNaN(r))return n&&n(r),r}function l(t,e){const n={};for(const r of e)s(t,r,(t=>{n[r]=t}));return n}function f(t){return 1===t?.nodeType}function h(t){return a(t,"line",(t=>Object.assign({},s(t,"color",(t=>({stroke:`#${t}`}))),c(t,"opacity",(t=>({"stroke-opacity":t}))),c(t,"width",(t=>({"stroke-width":96*t/25.4}))))))}function p(t){let e=[];if(null===t)return e;for(const n of Array.from(t.childNodes)){if(!f(n))continue;const t=g(n.nodeName);if("gpxtpx:TrackPointExtension"===t)e=e.concat(p(n));else{const r=o(n);e.push([t,d(r)])}}return e}function g(t){return["heart","gpxtpx:hr","hr"].includes(t)?"heart":t}function d(t){const e=parseFloat(t);return isNaN(e)?t:e}function y(t){const e=[parseFloat(t.getAttribute("lon")||""),parseFloat(t.getAttribute("lat")||"")];if(isNaN(e[0])||isNaN(e[1]))return null;u(t,"ele",(t=>{e.push(t)}));const n=i(t,"time");return{coordinates:e,time:n?o(n):null,extendedValues:p(i(t,"extensions"))}}function m(t){const e=l(t,["name","cmt","desc","type","time","keywords"]),r=Array.from(t.getElementsByTagNameNS("http://www.garmin.com/xmlschemas/GpxExtensions/v3","*"));for(const n of r)n.parentNode?.parentNode===t&&(e[n.tagName.replace(":","_")]=o(n));const i=n(t,"link");return i.length&&(e.links=i.map((t=>Object.assign({href:t.getAttribute("href")},l(t,["text","type"]))))),e}function b(t,e){const r=n(t,e),o=[],i=[],a={};for(let t=0;t<r.length;t++){const e=y(r[t]);if(e){o.push(e.coordinates),e.time&&i.push(e.time);for(const[n,o]of e.extendedValues){const e="heart"===n?n:n.replace("gpxtpx:","")+"s";a[e]||(a[e]=Array(r.length).fill(null)),a[e][t]=o}}}if(!(o.length<2))return{line:o,times:i,extendedValues:a}}function v(t){const e=b(t,"rtept");if(e)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},m(t),h(i(t,"extensions"))),geometry:{type:"LineString",coordinates:e.line}}}function x(t){const e=n(t,"trkseg"),r=[],o=[],a=[];for(const t of e){const e=b(t,"trkpt");e&&(a.push(e),e.times&&e.times.length&&o.push(e.times))}if(0===a.length)return null;const s=a.length>1,c=Object.assign({_gpxType:"trk"},m(t),h(i(t,"extensions")),o.length?{coordinateProperties:{times:s?o:o[0]}}:{});for(const t of a){r.push(t.line),c.coordinateProperties||(c.coordinateProperties={});const e=c.coordinateProperties,n=Object.entries(t.extendedValues);for(let t=0;t<n.length;t++){const[r,o]=n[t];s?(e[r]||(e[r]=a.map((t=>new Array(t.line.length).fill(null)))),e[r][t]=o):e[r]=o}}return{type:"Feature",properties:c,geometry:s?{type:"MultiLineString",coordinates:r}:{type:"LineString",coordinates:r[0]}}}function k(t){const e=Object.assign(m(t),l(t,["sym"])),n=y(t);return n?{type:"Feature",properties:e,geometry:{type:"Point",coordinates:n.coordinates}}:null}function*N(t){for(const e of n(t,"trk")){const t=x(e);t&&(yield t)}for(const e of n(t,"rte")){const t=v(e);t&&(yield t)}for(const e of n(t,"wpt")){const t=k(e);t&&(yield t)}}Object.defineProperty(e,"__esModule",{value:!0});const w="http://www.garmin.com/xmlschemas/ActivityExtension/v2",M=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],E=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function P(t,e){const n=[];for(const[r,a]of e){let e=i(t,r);if(!e){const n=t.getElementsByTagNameNS(w,r);n.length&&(e=n[0])}const s=parseFloat(o(e));isNaN(s)||n.push([a,s])}return n}function A(t){const e=[u(t,"LongitudeDegrees"),u(t,"LatitudeDegrees")];if(void 0===e[0]||isNaN(e[0])||void 0===e[1]||isNaN(e[1]))return null;const n=i(t,"HeartRateBpm"),r=o(i(t,"Time"));return i(t,"AltitudeMeters",(t=>{const n=parseFloat(o(t));isNaN(n)||e.push(n)})),{coordinates:e,time:r||null,heartRate:n?parseFloat(o(n)):null,extensions:P(t,M)}}function S(t){const e=n(t,"Trackpoint"),r=[],o=[],i=[];if(e.length<2)return null;const a={},s={extendedProperties:a};for(let t=0;t<e.length;t++){const n=A(e[t]);if(null===n)continue;r.push(n.coordinates);const{time:s,heartRate:c,extensions:u}=n;s&&o.push(s),c&&i.push(c);for(const[n,r]of u)a[n]||(a[n]=Array(e.length).fill(null)),a[n][t]=r}return r.length<2?null:Object.assign(s,{line:r,times:o,heartRates:i})}function L(t){const e=n(t,"Track"),r=[],i=[],s=[],c=[];let u;const l=Object.assign(Object.fromEntries(P(t,E)),a(t,"Name",(t=>({name:o(t)}))));for(const t of e)u=S(t),u&&(r.push(u.line),u.times.length&&i.push(u.times),u.heartRates.length&&s.push(u.heartRates),c.push(u.extendedProperties));for(let t=0;t<c.length;t++){const n=c[t];for(const o in n)1===e.length?u&&(l[o]=u.extendedProperties[o]):(l[o]||(l[o]=r.map((t=>Array(t.length).fill(null)))),l[o][t]=n[o])}return 0===r.length?null:((i.length||s.length)&&(l.coordinateProperties=Object.assign(i.length?{times:1===r.length?i[0]:i}:{},s.length?{heart:1===r.length?s[0]:s}:{})),{type:"Feature",properties:l,geometry:1===r.length?{type:"LineString",coordinates:r[0]}:{type:"MultiLineString",coordinates:r}})}function*F(t){for(const e of n(t,"Lap")){const t=L(e);t&&(yield t)}for(const e of n(t,"Courses")){const t=L(e);t&&(yield t)}}function G(t,e){const n={},r="stroke"==e||"fill"===e?e:e+"-color";return"#"===t[0]&&(t=t.substring(1)),6===t.length||3===t.length?n[r]="#"+t:8===t.length&&(n[e+"-opacity"]=parseInt(t.substring(0,2),16)/255,n[r]="#"+t.substring(6,8)+t.substring(4,6)+t.substring(2,4)),n}function T(t,e,n){const r={};return u(t,e,(t=>{r[n]=t})),r}function j(t,e){return a(t,"color",(t=>G(o(t),e)))}function C(t){return a(t,"Icon",((t,e)=>(s(t,"href",(t=>{e.icon=t})),e)))}function O(t){return Object.assign({},function(t){return a(t,"PolyStyle",((t,e)=>Object.assign(e,a(t,"color",(t=>G(o(t),"fill"))),s(t,"fill",(t=>{if("0"===t)return{"fill-opacity":0}})),s(t,"outline",(t=>{if("0"===t)return{"stroke-opacity":0}})))))}(t),function(t){return a(t,"LineStyle",(t=>Object.assign(j(t,"stroke"),T(t,"width","stroke-width"))))}(t),function(t){return a(t,"LabelStyle",(t=>Object.assign(j(t,"label"),T(t,"scale","label-scale"))))}(t),function(t){return a(t,"IconStyle",(t=>Object.assign(j(t,"icon"),T(t,"scale","icon-scale"),T(t,"heading","icon-heading"),a(t,"hotSpot",(t=>{const e=parseFloat(t.getAttribute("x")||""),n=parseFloat(t.getAttribute("y")||""),r=t.getAttribute("xunits")||"",o=t.getAttribute("yunits")||"";return isNaN(e)||isNaN(n)?{}:{"icon-offset":[e,n],"icon-offset-units":[r,o]}})),C(t))))}(t))}const _=t=>Number(t),R={string:t=>t,int:_,uint:_,short:_,ushort:_,float:_,double:_,bool:t=>Boolean(t)};function B(t,e){return a(t,"ExtendedData",((t,r)=>{for(const e of n(t,"Data"))r[e.getAttribute("name")||""]=o(i(e,"value"));for(const i of n(t,"SimpleData")){const t=i.getAttribute("name")||"",n=e[t]||R.string;r[t]=n(o(i))}return r}))}function I(t){const e=i(t,"description");for(const t of Array.from(e?.childNodes||[]))if(4===t.nodeType)return{description:{"@type":"html",value:o(t)}};return{}}function D(t){return a(t,"TimeSpan",(t=>({timespan:{begin:o(i(t,"begin")),end:o(i(t,"end"))}})))}function W(t){return a(t,"TimeStamp",(t=>({timestamp:o(i(t,"when"))})))}function H(t,e){return s(t,"styleUrl",(t=>(t=r(t),e[t]?Object.assign({styleUrl:t},e[t]):{styleUrl:t})))}const U=/\s*/g,V=/^\s*|\s*$/g,q=/\s+/;function z(t){return t.replace(U,"").split(",").map(parseFloat).filter((t=>!isNaN(t))).slice(0,3)}function $(t){return t.replace(V,"").split(q).map(z).filter((t=>t.length>=2))}function Q(t){let e=n(t,"coord");var r;0===e.length&&(r=t,"coord","*",e=Array.from(r.getElementsByTagNameNS("*","coord")));const i=e.map((t=>o(t).split(" ").map(parseFloat)));return 0===i.length?null:{geometry:i.length>2?{type:"LineString",coordinates:i}:{type:"Point",coordinates:i[0]},times:n(t,"when").map((t=>o(t)))}}function J(t){if(0===t.length)return t;const e=t[0],n=t[t.length-1];let r=!0;for(let t=0;t<Math.max(e.length,n.length);t++)if(e[t]!==n[t]){r=!1;break}return r?t:t.concat([t[0]])}function K(t){return o(i(t,"coordinates"))}function X(t){let e=[],r=[];for(let o=0;o<t.childNodes.length;o++){const i=t.childNodes.item(o);if(f(i))switch(i.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const t=X(i);e=e.concat(t.geometries),r=r.concat(t.coordTimes);break}case"Point":{const t=z(K(i));t.length>=2&&e.push({type:"Point",coordinates:t});break}case"LinearRing":case"LineString":{const t=$(K(i));t.length>=2&&e.push({type:"LineString",coordinates:t});break}case"Polygon":{const t=[];for(const e of n(i,"LinearRing")){const n=J($(K(e)));n.length>=4&&t.push(n)}t.length&&e.push({type:"Polygon",coordinates:t});break}case"Track":case"gx:Track":{const t=Q(i);if(!t)break;const{times:n,geometry:o}=t;e.push(o),n.length&&r.push(n);break}}}return{geometries:e,coordTimes:r}}function Y(t,e,n,r){const{coordTimes:o,geometries:i}=X(t),a=function(t){return 0===t.length?null:1===t.length?t[0]:{type:"GeometryCollection",geometries:t}}(i);if(!a&&r.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign(l(t,["name","address","visibility","open","phoneNumber","description"]),I(t),H(t,e),O(t),B(t,n),D(t),W(t),o.length?{coordinateProperties:{times:1===o.length?o[0]:o}}:{})};void 0!==s.properties?.visibility&&(s.properties.visibility="0"!==s.properties.visibility);const c=t.getAttribute("id");return null!==c&&""!==c&&(s.id=c),s}const Z=Math.PI/180;function tt(t,e,n,r){const o=function(t){return i(t,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[J($(K(t)))]}}:function(t){const e=i(t,"LatLonBox");if(e){const t=u(e,"north"),n=u(e,"west"),r=u(e,"east"),o=u(e,"south"),i=u(e,"rotation");if("number"==typeof t&&"number"==typeof o&&"number"==typeof n&&"number"==typeof r){const e=[n,o,r,t];let a=[[[n,t],[r,t],[r,o],[n,o],[n,t]]];return"number"==typeof i&&(a=function(t,e,n){const r=[(t[0]+t[2])/2,(t[1]+t[3])/2];return[e[0].map((t=>{const e=t[1]-r[1],o=t[0]-r[0],i=Math.sqrt(Math.pow(e,2)+Math.pow(o,2)),a=Math.atan2(e,o)+n*Z;return[r[0]+Math.cos(a)*i,r[1]+Math.sin(a)*i]}))]}(e,a,i)),{bbox:e,geometry:{type:"Polygon",coordinates:a}}}}return null}(t)}(t),a=o?.geometry||null;if(!a&&r.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"groundoverlay"},l(t,["name","address","visibility","open","phoneNumber","description"]),I(t),H(t,e),O(t),C(t),B(t,n),D(t),W(t))};o?.bbox&&(s.bbox=o.bbox),void 0!==s.properties?.visibility&&(s.properties.visibility="0"!==s.properties.visibility);const c=t.getAttribute("id");return null!==c&&""!==c&&(s.id=c),s}function et(t){let e=t.getAttribute("id");const n=t.parentNode;return!e&&f(n)&&"CascadingStyle"===n.localName&&(e=n.getAttribute("kml:id")||n.getAttribute("id")),r(e||"")}function nt(t){const e={};for(const r of n(t,"Style"))e[et(r)]=O(r);for(const o of n(t,"StyleMap")){const t=r(o.getAttribute("id")||"");s(o,"styleUrl",(n=>{n=r(n),e[n]&&(e[t]=e[n])}))}return e}function rt(t){const e={};for(const r of n(t,"SimpleField"))e[r.getAttribute("name")||""]=R[r.getAttribute("type")||""]||R.string;return e}const ot=["name","visibility","open","address","description","phoneNumber","visibility"];function*it(t,e={skipNullGeometry:!1}){const r=nt(t),o=rt(t);for(const i of n(t,"Placemark")){const t=Y(i,r,o,e);t&&(yield t)}for(const i of n(t,"GroundOverlay")){const t=tt(i,r,o,e);t&&(yield t)}}e.gpx=function(t){return{type:"FeatureCollection",features:Array.from(N(t))}},e.gpxGen=N,e.kml=function(t,e={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(it(t,e))}},e.kmlGen=it,e.kmlWithFolders=function(t,e={skipNullGeometry:!1}){const n=nt(t),r=rt(t),i={type:"root",children:[]};return function t(e,i,a){if(f(e))switch(e.tagName){case"GroundOverlay":{const t=tt(e,n,r,a);t&&i.children.push(t);break}case"Placemark":{const t=Y(e,n,r,a);t&&i.children.push(t);break}case"Folder":{const t=function(t){const e={};for(const n of Array.from(t.childNodes))f(n)&&ot.includes(n.tagName)&&(e[n.tagName]=o(n));return{type:"folder",meta:e,children:[]}}(e);i.children.push(t),i=t;break}}if(e.childNodes)for(let n=0;n<e.childNodes.length;n++)t(e.childNodes[n],i,a)}(t,i,e),i},e.tcx=function(t){return{type:"FeatureCollection",features:Array.from(F(t))}},e.tcxGen=F}}]);